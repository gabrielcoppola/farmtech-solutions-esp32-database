# FIAP - Faculdade de Inform√°tica e Administra√ß√£o Paulista

<p align="center">
    <a href= "https://www.fiap.com.br/"><img src="assets/logo-fiap.png" alt="FIAP - Faculdade de Inform√°tica e Admnistra√ß√£o Paulista" border="0" width=40% height=40%></a>
</p>

<br>

# Sistema de Irriga√ß√£o Inteligente para Tomates com ESP32

## üë®‚Äçüéì Integrantes: 

- Gabriel Coppola - RM568044
- Marina Clara Constantino Ribeiro - RM568576
- Yasmin Kauane Silva Lima - RM566645
- Diego Filipe Pereira de Araujo - RM567064

# Documenta√ß√£o do Arquivo CSV de Dados de Sensores (FarmTech Solutions) - Multi-Cultura

Este relat√≥rio apresenta a estrutura do arquivo `document/farmtech_sensor_data_multi_cultura.csv`, que cont√©m dados sint√©ticos sobre diferentes culturas agr√≠colas t√≠picas do estado de S√£o Paulo, e inclui orienta√ß√µes para sua correta importa√ß√£o no ambiente **Oracle SQL Developer**.

Al√©m de detalhar a cria√ß√£o da tabela no **Oracle Database 21c Express Edition**, o documento descreve de forma pr√°tica e passo a passo de todo o processo de importa√ß√£o do arquivo CSV, servindo como um guia de refer√™ncia para o armazenamento e an√°lise dos dados coletados por sensores agr√≠colas.

## 1. Estrutura do Arquivo CSV

O arquivo foi gerado com **3000 registros** (500 para cada uma das 6 culturas), simulando leituras de sensores a cada 10 minutos.

| Coluna | Tipo de Dado (Sugerido Oracle) | Descri√ß√£o | Exemplo |
| :--- | :--- | :--- | :--- |
| **TIMESTAMP** | `TIMESTAMP` | Data e hora da leitura do sensor. | `2025-10-01 00:00:00` |
| **ID_SENSOR** | `VARCHAR2(15)` | Identificador do dispositivo ESP32, agora espec√≠fico por cultura (ex: `ESP32_TOM_001`). | `ESP32_CAN_002` |
| **CULTURA** | `VARCHAR2(50)` | Cultura monitorada. Inclui: Tomate, Cana-de-A√ß√∫car, Laranja, Milho, Soja, Caf√©. | `Cana-de-A√ß√∫car` |
| **FASE_CULTURA** | `VARCHAR2(50)` | Fase de desenvolvimento da cultura. | `Plantio` |
| **TEMPERATURA_AR_C** | `NUMBER(4,2)` | Temperatura do ar em graus Celsius. | `28.15` |
| **UMIDADE_AR_PERC** | `NUMBER(4,2)` | Umidade relativa do ar em porcentagem. | `55.90` |
| **PH_SOLO** | `NUMBER(3,2)` | N√≠vel de pH do solo (escala 0.0 a 14.0). | `6.25` |
| **UMIDADE_SOLO_PERC** | `NUMBER(4,2)` | Umidade do solo em porcentagem. | `65.40` |
| **N_PRESENTE** | `NUMBER(1)` | Simula√ß√£o de presen√ßa de Nitrog√™nio (0=N√£o, 1=Sim). | `1` |
| **P_PRESENTE** | `NUMBER(1)` | Simula√ß√£o de presen√ßa de F√≥sforo (0=N√£o, 1=Sim). | `0` |
| **K_PRESENTE** | `NUMBER(1)` | Simula√ß√£o de presen√ßa de Pot√°ssio (0=N√£o, 1=Sim). | `1` |
| **BOMBA_LIGADA** | `NUMBER(1)` | Estado da bomba de √°gua (0=Desligada, 1=Ligada). | `0` |

## 2. Par√¢metros de Gera√ß√£o e L√≥gica

Os dados foram gerados com base nos seguintes par√¢metros ideais para cada cultura, influenciando as leituras dos sensores e a l√≥gica de atua√ß√£o da bomba:

| Cultura | pH Ideal | Umidade do Solo Ideal (%) | Temperatura Ideal (¬∞C) |
| :--- | :--- | :--- | :--- |
| **Tomate** | 6.0 - 7.0 | 60 - 80 | 20 - 28 |
| **Cana-de-A√ß√∫car** | 6.0 - 6.5 | 50 - 70 | 22 - 30 |
| **Laranja** | 5.5 - 6.5 | 50 - 70 | 23 - 32 |
| **Milho** | 5.5 - 7.0 | 60 - 85 | 24 - 30 |
| **Soja** | 6.0 - 7.0 | 60 - 80 | 20 - 30 |
| **Caf√©** | 6.0 - 6.5 | 50 - 70 | 18 - 22 |

*   **L√≥gica da Bomba:** A coluna `BOMBA_LIGADA` (0 ou 1) simula a atua√ß√£o do rel√©, adaptando-se aos par√¢metros ideais de **pH** e **Umidade do Solo** de cada cultura.
    *   **Liga (1):** Se Umidade do Solo < 50% **OU** (Umidade do Solo < 60% **E** pH fora da faixa ideal da cultura).
    *   **Desliga (0):** Caso contr√°rio.

## 2. Detalhamento da Cria√ß√£o da Tabela

A tabela `DADOS_SENSORES_FARMTECH` √© a estrutura central para armazenar os dados. A cria√ß√£o da tabela deve ser executada no SQL Developer.

### 2.1. Script Completo

O script a seguir inclui uma coluna de chave prim√°ria auto-increment√°vel, uma pr√°tica recomendada para rastreamento de registros.

\`\`\`sql
CREATE TABLE DADOS_SENSORES_FARMTECH (
    ID_REGISTRO NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,

    TIMESTAMP TIMESTAMP NOT NULL,
    ID_SENSOR VARCHAR2(15) NOT NULL,
    CULTURA VARCHAR2(50),
    FASE_CULTURA VARCHAR2(50),

    TEMPERATURA_AR_C NUMBER(4,2),
    UMIDADE_AR_PERC NUMBER(4,2),
    PH_SOLO NUMBER(3,2),
    UMIDADE_SOLO_PERC NUMBER(4,2),

    N_PRESENTE NUMBER(1),
    P_PRESENTE NUMBER(1),
    K_PRESENTE NUMBER(1),

    BOMBA_LIGADA NUMBER(1)
);

COMMENT ON TABLE DADOS_SENSORES_FARMTECH IS 'Dados de sensores agr√≠colas do projeto FarmTech Solutions.';

CREATE INDEX IDX_FARMTECH_TIMESTAMP ON DADOS_SENSORES_FARMTECH (TIMESTAMP);
\`\`\`

![Diagrama do sistema](document/images/dados-tabela.png "Cria√ß√£o da Tabela")

### 2.2. Explica√ß√£o das Colunas Chave

| Coluna | Tipo de Dado | Detalhamento |
| :--- | :--- | :--- |
| **ID_REGISTRO** | `NUMBER` | **Chave Prim√°ria**. Definida com `GENERATED BY DEFAULT ON NULL AS IDENTITY`, o que faz com que o Oracle gere automaticamente um valor sequencial para cada novo registro. |
| **TIMESTAMP** | `TIMESTAMP` | Armazena a data e hora exatas da leitura. O tipo `TIMESTAMP` √© essencial para dados de s√©ries temporais. |
| **ID_SENSOR** | `VARCHAR2(15)` | Identificador alfanum√©rico do dispositivo (ex: `ESP32_TOM_001`). |
| **TEMPERATURA_AR_C** | `NUMBER(4,2)` | N√∫mero com 4 d√≠gitos no total, sendo 2 para a parte decimal (ex: 25.45). |
| **PH_SOLO** | `NUMBER(3,2)` | N√∫mero com 3 d√≠gitos no total, sendo 2 para a parte decimal (ex: 6.52). |
| **BOMBA_LIGADA** | `NUMBER(1)` | Campo bin√°rio (0 ou 1) para o status de atua√ß√£o. |

## 3. Detalhamento da Importa√ß√£o de Dados via SQL Developer

O Oracle SQL Developer possui um assistente de importa√ß√£o robusto que facilita a carga de dados de arquivos CSV. O arquivo **`document/farmtech_sensor_data_multi_cultura.csv`** utiliza o ponto e v√≠rgula (`;`) como delimitador, o que requer aten√ß√£o especial durante a configura√ß√£o.

### 3.1. Passo a Passo do Assistente de Importa√ß√£o

| Etapa | A√ß√£o no SQL Developer | Configura√ß√£o Crucial |
| :--- | :--- | :--- |
| **1. Iniciar** | Clique com o bot√£o direito na tabela `DADOS_SENSORES_FARMTECH` (ap√≥s cri√°-la) e selecione **"Importar Dados..."**. | Selecione o arquivo `document/farmtech_sensor_data_multi_cultura.csv`. |

![Diagrama do sistema](document/images/import-0.png "Importar Dados")

| **2. Formato** | O assistente tentar√° adivinhar o formato. Corrija manualmente. | **Delimitador de Campo:** Mude de v√≠rgula (`,`) para **Ponto e V√≠rgula (`;`)**. |

![Diagrama do sistema](document/images/import-1.png "Importar Dados")

| **3. Colunas** | Revise o mapeamento das colunas do arquivo para as colunas da tabela. | **Aten√ß√£o:** A coluna `ID_REGISTRO` da tabela **n√£o deve ser mapeada** a nenhuma coluna do CSV, pois ela √© gerada automaticamente pelo Oracle. |

![Diagrama do sistema](document/images/import-2.png "Importar Dados")

| **4. Tipos de Dados** | Esta √© a etapa mais cr√≠tica para o campo de data/hora. | Para a coluna **`TIMESTAMP`**, defina o **Formato de Data** como: `YYYY-MM-DD HH24:MI:SS`. |
| **5. M√©todo** | Escolha o m√©todo de inser√ß√£o. | Selecione **"Insert"** para inserir os novos registros na tabela. |
| **6. Concluir** | Revise o resumo e clique em **"Concluir"** para iniciar a importa√ß√£o. | O assistente deve reportar a inser√ß√£o de 3000 linhas. |

![Diagrama do sistema](document/images/import-3.png "Importar Dados")

### 3.2. Configura√ß√£o Cr√≠tica do Formato de Data

O arquivo CSV utiliza o formato `YYYY-MM-DD HH:MI:SS`. Para que o Oracle o interprete corretamente, √© fundamental que o formato de data no assistente de importa√ß√£o seja definido exatamente como:

```
YYYY-MM-DD HH24:MI:SS
```

*   **`HH24`**: Garante o uso do formato de 24 horas (00 a 23).
*   **`MI`**: Representa os minutos.
*   **`SS`**: Representa os segundos.

## 4. Consultas SQL para An√°lise de Dados

Ap√≥s a importa√ß√£o, voc√™ pode executar as seguintes consultas para validar e analisar os dados:

### 4.1. Consulta 1: Contagem de Registros por Cultura

```sql
SELECT
    CULTURA,
    COUNT(*) AS TOTAL_REGISTROS
FROM
    DADOS_SENSORES_FARMTECH
GROUP BY
    CULTURA
ORDER BY
    TOTAL_REGISTROS DESC;
```

### 4.2. Consulta 2: M√©dia de pH e Umidade por Cultura

```sql
SELECT
    CULTURA,
    ROUND(AVG(PH_SOLO), 2) AS PH_MEDIO,
    ROUND(AVG(UMIDADE_SOLO_PERC), 2) AS UMIDADE_SOLO_MEDIA,
    ROUND(AVG(TEMPERATURA_AR_C), 2) AS TEMPERATURA_MEDIA
FROM
    DADOS_SENSORES_FARMTECH
GROUP BY
    CULTURA
ORDER BY
    CULTURA;
```

### 4.3. Consulta 3: Frequ√™ncia de Acionamento da Bomba

```sql
SELECT
    CULTURA,
    SUM(BOMBA_LIGADA) AS VEZES_BOMBA_LIGADA,
    ROUND((SUM(BOMBA_LIGADA) / COUNT(*)) * 100, 2) AS PERCENTUAL_ACIONAMENTO
FROM
    DADOS_SENSORES_FARMTECH
GROUP BY
    CULTURA
ORDER BY
    PERCENTUAL_ACIONAMENTO DESC;
```

## üé• Demonstra√ß√£o em V√≠deo

Veja a demonstra√ß√£o completa de funcionamento neste v√≠deo no YouTube.

**O v√≠deo mostra:**
- Explica√ß√£o dos componentes
- Circuito no Wokwi funcionando
- Cen√°rio 1: Solo seco ‚Üí Bomba liga
- Cen√°rio 2: Solo ideal ‚Üí Bomba desliga
- Cen√°rio 3: Solo saturado ‚Üí Bomba desliga

## üîó Links Importantes

- **V√≠deo Demonstrativo:** [Youtube](https://youtu.be/XHSX82LDZh0)
- **Reposit√≥rio GitHub:** [C√≥digo completo](https://github.com/gabrielcoppola/farmtech-solutions-esp32)

## üìã Licen√ßa

<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://github.com/agodoi/template">MODELO GIT FIAP</a> por <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://fiap.com.br">Fiap</a> est√° licenciado sobre <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">Attribution 4.0 International</a>.</p>